---
version: "3"

vars:
  PROJECT_DIR:
    sh: "git rev-parse --show-toplevel"

includes:
  es:
    taskfile: .taskfiles/secrets
  fmt:
    taskfile: .taskfiles/format
  fx:
    taskfile: .taskfiles/flux
  kub:
    taskfile: .taskfiles/kubernetes
  pc:
    taskfile: .taskfiles/pre-commit
  pg:
    taskfile: .taskfiles/postgres
  redis:
    taskfile: .taskfiles/redis
  rook:
    taskfile: .taskfiles/rook
  sops:
    taskfile: .taskfiles/sops
  talos:
    taskfile: .taskfiles/talos
  vs:
    taskfile: .taskfiles/volsync

tasks:
  secrets:
    desc: Encode config and secrets
    cmds:
      - |
        infrastructure/setup/build-config.sh

  default:
    silent: true
    cmds:
      - task -l
