---
version: "3"

vars:
  PROJECT_DIR:
    sh: "git rev-parse --show-toplevel"

includes:
  es: .taskfiles/ExternalSecrets.yaml
  fmt: .taskfiles/Format.yaml
  fx: .taskfiles/Flux.yaml
  kub: .taskfiles/Kubernetes.yaml
  pc: .taskfiles/PreCommit.yaml
  pg: .taskfiles/Postgres.yaml
  redis: .taskfiles/Redis.yaml
  rook: .taskfiles/Rook.yaml
  sops: .taskfiles/Sops.yaml
  vs: .taskfiles/VolSync.yaml

tasks:
  secrets:
    desc: Encode config and secrets
    cmds:
      - |
        infrastructure/setup/build-config.sh
